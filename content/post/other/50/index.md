---
title: "Android StudioでGitを使ったバージョン管理"
slug: 50
date: 2014-09-05
lastmod: 2014-09-18
tags: 
    - Git
---

Android StudioでGitを利用したバージョン管理ができます。Git以外にもGitHubやSubversionなども使えるのですが、私はGitを使っているのでGitで説明します。

ちなみに私のGit力はGUIでしか管理できないレベルなので、コマンドで管理するのはどうするのかは聞かないでください・・・。これまでずっとSourceTreeでしかGit触ったことがないのです。


## リポジトリの作成の仕方


まずはAndroid StudioでGitのリポジトリを作成する方法です。今回はSampleGitというプロジェクトを例に説明します。

メニューの`VCS > Inport into Version Control > Create Git Repository`を選択します。

![Gitリポジトリを作成する](a346805bf9b431256ccc2ee2df8090e2.jpg)

そうすると、リポジトリを作成する場所を聞いてくるのでプロジェクトルートを選択します。

![Gitリポジトリを作成するディレクトリを選択する](d7adcc4b8d3001aff83e9bfee36f883b.jpg)

これでGitリポジトリが作成されます。

Gitリポジトリが作成されると、Android Studioの下部にChangesという項目が新たに増えます。このタブでコミットしたり、Gitのログを確認したりといった作業を行えます。

![Android Studioの下部にChangesというタブができる](ea95e31b3b24f905d0ba921d51144b9e.jpg)

また、リポジトリを作成したことによりプロジェクトウィンドウ等に表示されるファイル名の色が変わります。色の意味はこんな感じです。

<ul>
<li>赤色：Gitで管理されていないファイル</li>
<li>緑色：新規に作成されたファイル（まだコミットされていないファイル）</li>
<li>青色：コミット後に変更があったファイル</li>
<li>白色：コミットされたファイル（もしくは.gitignoreによってGit管理下から除外されているファイル）</li>
</ul>

リポジトリ作成直後はほとんどのファイル名が赤色になっていると思うので、まずはGit管理下においてやる必要があります。


## ファイルをGit管理下に追加する


下部にあるChangesツールウィンドウを開くと、Unversioning Filesという部分に、赤色で表示されているファイルの一覧がずらっと並んでいます。

これらのファイルを右クリック→Add to VCS（もしくは`cmd+option+a`）でGit管理下においてやります。そうするとファイル名が赤から緑色に変わります。

![Android StudioでファイルをGit管理下に追加する方法](c86454f3f70c6ed6fcac7471b51ebd28.jpg)

1つ1つファイルを選ばずとも、Unversioning Filesという部分を右クリックしてAdd to VCSとすれば一気に全部変更できます。


### （余談）リポジトリ作成後に新規ファイルを作成した場合


ちなみに、リポジトリを作成した後にファイルを追加すると、Git管理下におくかどうかきいてくるので、Yesを押せばわざわざこんな面倒臭いことをしなくてすみます。

![新たにファイルを作成した時に出てくるメッセージ](7e8ae9512e6b1e464f0e5d683a72ec06.jpg)


## コミットの仕方


ファイルをGit管理下に加えた後はコミットするだけです。以下のいずれかの方法でコミットを行うためのダイアログが表示されます。

<ul>
<li>メニューの`VCS > Commit Changes`</li>
<li>ChangesツールウィンドウのVCSの文字の下に上矢印のついたアイコンをクリック</li>
<li>キーボードショートカット`cmd+k`</li>
</ul>

![コミットの仕方](41a0fb491dbcff9a1ff52eddd78925f3.jpg)

後はコミットするファイルにチェックをつけて、コミットメッセージを入力して、Commitボタンを押せばOKです。

ちなみにコミットする際にCode Analysisが働いて確認ダイアログが表示されることがあります。

![Code Analysisのメッセージ](b0021ce382d50925eed8de911c43edef.jpg)

コミットする前にコードをチェックしてくれる機能で、「こういう風にした方がいいんじゃね？」という提案ではありますが、正直細かすぎる指摘もあるので、Warning程度であれば無視してもいいと思います。

Reviewを押せばWarning等の内容が表示されるので、無視してコミットする場合はCommitのボタンを押せばコミットできます。


### Changesツールウィンドウを使ってコミットする際の注意点


Changesツールウィンドウを使ってコミットをする際は、リストに表示されている1つのファイルを選択した状態でVCSアイコンを押さないように気をつけましょう。

その場合、選択されているファイルしかコミット対象にならないことがあります。私はよく1ファイルだけコミットされてないという状況に陥りました。

そんなときは再度コミットするファイルを選び直し、`Ammend commit`にチェックをつけてコミットすると、直前のコミットを修正することができます。


## コミット後のファイルの変更


コミット後にファイルに変更を加えると、ファイル名が青くなります。

![コミット後にファイルに変更を加える](894a716c54ad26253f5e4fb27ca3d6d3.jpg)

またファイル名だけでなく、ソースコードの変更した部分のウィンドウの端にも色がつくようになります。この部分の色も、新規追加が緑、変更が青という規則にそっています。覚えておくと何かと便利かもしれません。


  